# UNAT 알려진 이슈 및 제한사항

> 현재 알려진 버그, 제한사항, 개선 필요 항목

---

## 🐛 알려진 버그

### Phase 1 관련

현재 발견된 버그 없음

---

## ⚠️ 제한사항

### 1. APK Handler

#### 1.1 Androguard 의존성
- **현상**: Androguard 버전에 따라 일부 APK 파싱 실패 가능
- **영향**: 특정 난독화/패킹된 APK 분석 불가
- **대응**:
  - 현재 Androguard 4.1.3 사용
  - 향후 대체 파서 고려 (apktool, aapt)

#### 1.2 대용량 APK
- **현상**: 100MB 이상 APK 로드 시 메모리 사용량 증가
- **영향**: 저사양 환경에서 성능 저하
- **대응**:
  - 추후 스트리밍 파싱 고려
  - config/default_config.yaml에 메모리 제한 설정 추가됨

#### 1.3 AndroidManifest.xml 파싱
- **현상**: 일부 바이너리 XML 디코딩 실패 가능
- **영향**: Manifest 정보 불완전
- **대응**: Androguard 기본 동작 사용

### 2. Device Manager

#### 2.1 ADB 경로
- **현상**: 시스템 PATH에 adb가 없으면 연결 실패
- **영향**: 수동으로 adb 경로 지정 필요
- **대응**:
  - config/default_config.yaml에서 adb_path 설정 가능
  - 에러 메시지로 사용자 안내

#### 2.2 Frida 서버 탐지
- **현상**: Frida 서버가 실행 중이지 않으면 연결 불가
- **영향**: 동적 분석 기능 사용 불가
- **대응**:
  - 현재는 탐지만 수행
  - 향후 자동 Frida 서버 푸시 및 실행 기능 추가 예정

#### 2.3 루팅 탐지
- **현상**: 단순 `su` 바이너리 존재 확인으로만 판단
- **영향**: Magisk Hide 등으로 숨겨진 루팅 탐지 불가
- **대응**:
  - 기본적인 탐지만 제공
  - 향후 더 정교한 루팅 탐지 추가 예정

#### 2.4 멀티 디바이스
- **현상**: 여러 디바이스 연결 시 serial 지정 필수
- **영향**: 자동 선택 불가
- **대응**:
  - `-s <serial>` 옵션으로 디바이스 지정
  - 에러 메시지로 사용자 안내

### 3. CLI

#### 3.1 --version 플래그
- **현상**: `unat --version`이 명령어 없이 작동 안 함
- **영향**: 버전 확인 시 불편
- **상태**: 알려진 Click 동작
- **대응**: 현재 그대로 유지 (major issue 아님)

#### 3.2 Rich 미설치 시
- **현상**: Rich 라이브러리 없으면 fallback 텍스트 출력
- **영향**: UI 품질 저하
- **대응**:
  - requirements.txt에 포함되어 있음
  - Warning 메시지 출력

---

## 🔧 개선 필요 항목

### 1. 에러 핸들링

#### 1.1 APK 파일 검증
- **현재**: 파일 존재 여부만 확인
- **개선 필요**:
  - APK 파일 형식 검증 (ZIP 구조)
  - 손상된 APK 탐지
  - 명확한 에러 메시지

#### 1.2 ADB 타임아웃
- **현재**: 기본 30초 타임아웃
- **개선 필요**:
  - 명령어별 차등 타임아웃
  - 사용자 설정 가능

### 2. 성능

#### 2.1 APK 정보 캐싱
- **현재**: 매번 전체 APK 파싱
- **개선 필요**:
  - 파싱 결과 캐싱
  - 증분 분석 지원

#### 2.2 병렬 처리
- **현재**: 순차 처리
- **개선 필요**:
  - 멀티 APK 분석 시 병렬 처리
  - 진행 상황 표시

### 3. 사용성

#### 3.1 설정 파일 우선순위
- **현재**: config/default_config.yaml만 사용
- **개선 필요**:
  - 사용자 설정 파일 지원 (config/user_config.yaml)
  - CLI 옵션 > 사용자 설정 > 기본 설정 우선순위

#### 3.2 출력 포맷
- **현재**: 터미널 출력만
- **개선 필요**:
  - JSON 출력 옵션
  - 파일 저장 옵션
  - 조용한 모드 (--quiet)

### 4. 테스트

#### 4.1 단위 테스트
- **현재**: 테스트 코드 없음
- **개선 필요**:
  - pytest 기반 테스트 작성
  - CI/CD 통합

#### 4.2 통합 테스트
- **현재**: 수동 테스트만
- **개선 필요**:
  - 샘플 APK로 자동 테스트
  - 에뮬레이터 기반 테스트

---

## 🚧 플랫폼별 이슈

### Windows

#### PATH 관련
- **현상**: PowerShell에서 `venv\Scripts\activate` 실행 시 권한 오류 가능
- **대응**:
  - `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`
  - 또는 `venv\Scripts\activate.bat` 사용

#### ADB 경로
- **현상**: Android Studio SDK 경로에 공백 있으면 문제 발생 가능
- **대응**:
  - 경로를 따옴표로 감싸거나
  - config에서 직접 지정

### Linux/Mac

- **상태**: 미테스트
- **예상 이슈**:
  - 경로 구분자 차이 (Windows `\` vs Unix `/`)
  - 현재 대부분 Path 객체 사용으로 문제 없을 것으로 예상

---

## 📋 향후 개선 계획

### Phase 2 (Discovery 모듈)
- Java 클래스/메서드 탐색 시 성능 최적화 필요
- Native 함수 탐색 시 바이너리 파서 선택 (pyelftools vs capstone)

### Phase 3 (Hooking 엔진)
- Frida 스크립트 에러 핸들링 강화
- 스크립트 핫 리로드 지원

### Phase 4 (Evasion 모듈)
- Anti-Frida 탐지 우회 패턴 계속 업데이트 필요
- 앱별 커스텀 우회 전략 지원

---

## 💡 제안 사항

### 커뮤니티 기여
- 이슈를 발견하면 GitHub Issues에 등록
- 개선 제안은 Pull Request로 기여

### 테스트 데이터
- 다양한 APK로 테스트하여 호환성 확인
- 문제 APK는 이슈에 공유 (민감 정보 제외)

---

## 📌 이슈 보고 템플릿

```markdown
### 환경
- OS: Windows/Linux/Mac
- Python 버전:
- UNAT 버전:
- ADB 버전:
- Frida 버전:

### 증상
[이슈 설명]

### 재현 방법
1.
2.
3.

### 예상 동작
[예상했던 동작]

### 실제 동작
[실제로 일어난 동작]

### 에러 메시지
```
[에러 메시지 또는 로그]
```

### 추가 정보
[스크린샷, 로그 파일 등]
```

---

_마지막 업데이트: 2024-12-10_
